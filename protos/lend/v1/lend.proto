syntax = "proto3";

package lend.v1; 
option go_package = "github.com/fox-one/pando-protos/lend/v1;lend";

import "common/v1/common.proto";

service LendService {
    rpc Info(InfoRequest) returns (InfoResponse);
    rpc CreateOperationLog(CreateOperationLogRequest) returns (CreateOperationLogResponse);
    rpc GetOperationLog(GetOperationLogRequest) returns (GetOperationLogResponse);
}

message TransferData {
  OperationType operation_type = 1;
  TransferPledgeData pledge = 2;
  TransferLoanData loan = 3;
  TransferRepayData repay = 4;
  TransferWithdrawData withdraw = 5;
}

message TransferWithdrawData {
  PledgeType pledge_type = 1;
  string asset_id = 2;
  string amount = 3;
}

message TransferPledgeData {
  PledgeType pledge_type = 1;
}

message TransferLoanData {
  string amount = 1;
}

message TransferRepayData {}

enum OperationType {
  OPERATION_TYPE_NOT_SET = 0;
  PLEDGE = 1;
  WITHDRAW = 2;
  LOAN = 3;
  REPAY = 4;
}

enum OperationStatus {
  OPERATION_STATUS_NOT_SET = 0;
  PENDING = 1;
  SUCCESS = 2;
  FAILED = 3;
}

enum PledgeType {
  PLEDGE_TYPE_NOT_SET = 0;
  NODE = 1;
  POOL = 2;
  LOCAL = 3;
}

message PledgeItem {
  PledgeType pledge_type = 1;
  common.v1.Asset asset = 2;
  string amount = 3;
  string price = 4;
  int32 price_at = 5;
}

message InfoRequest {}

message InfoResponse {
  string loan_amount = 1;
  string loan_interest = 2;
  repeated PledgeItem items = 3;
  string pledge_amount = 4;
}

message CreateOperationLogRequest {
  string trace_id = 1;
}

message CreateOperationLogResponse {}

message GetOperationLogRequest {
  string trace_id = 1;
}

message OperationLog {
  string trace_id = 1;
  OperationType operation_type = 2;
  string loan_amount = 3;
  string repay_amount = 4;
  PledgeType pledge_type = 5;
  string pledge_amount = 6;
  common.v1.Asset pledge_asset = 7;
  OperationStatus status = 8;
  int32 created_at = 9;
}

message GetOperationLogResponse {
  OperationLog operation_log = 1;
}
